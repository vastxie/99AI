
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as oe}from"./index-fd8a5577.js";import{Y as V,d as ae,Q as U,r as _,B as ne,x as se,h as n,R as ue,o as A,c as $,e,f as o,k as re,m as pe,S as ie,U as de,b as s,l as p,w as ce,I as q,t as R,a as me,V as _e,E as k,X as fe,q as M}from"./index-e656eb90.js";import{u as I}from"./utcformatTime-e76e5157.js";import{b as ye,Q as ge}from"./index-d5406c70.js";const C={queryAutoReply:i=>V.get("autoreply/query",{params:i}),delAutoReply:i=>V.post("autoreply/del",i),addAutoReply:i=>V.post("autoreply/add",i),updateAutoReply:i=>V.post("autoreply/update",i)},ve={class:"dialog-footer"},we=ae({__name:"autpReply",setup(i){const u=U({prompt:"",status:void 0,page:1,size:10}),c=_(!1),b=_(!1),g=_(0),S=_(0),z=_(),h=_(),r=U({status:0,prompt:"",answer:""}),N=U({status:[{required:!0,message:"请选择套餐类型",trigger:"change"}],prompt:[{required:!0,message:"请填写预设问题",trigger:"blur"}],answer:[{required:!0,message:"请填写回复答案",trigger:"blur"}]}),T=_([]);async function d(){try{b.value=!0;const a=await C.queryAutoReply(u),{rows:l,count:v}=a.data;b.value=!1,S.value=v,T.value=l}catch{b.value=!1}}async function B(a){await C.delAutoReply({id:a}),k.success("删除自定义问题成功"),await d()}function O(a){a==null||a.resetFields(),d()}function P(a){g.value=a.id;const{status:l,prompt:v,answer:w}=a;c.value=!0,fe(()=>{Object.assign(r,{status:l,prompt:v,answer:w})})}const D=ne(()=>g.value!==0);function Q(a){a==null||a.resetFields(),g.value=0}async function j(a){a==null||a.validate(async l=>{if(!l)return k.warning("请按规则填写所有信息！");g.value===0?(await C.addAutoReply(r),k.success("添加自定义问题成功")):(await C.updateAutoReply({id:g.value,...r}),k.success("更新自定义问题成功")),c.value=!1,d()})}return se(()=>{d()}),(a,l)=>{const v=n("el-alert"),w=oe,x=n("el-input"),f=n("el-form-item"),F=n("el-option"),K=n("el-select"),m=n("el-button"),L=n("Plus"),X=n("el-icon"),Y=n("el-form"),y=n("el-table-column"),G=n("el-tag"),H=n("el-popconfirm"),J=n("el-table"),W=n("el-pagination"),Z=n("el-row"),E=n("el-switch"),ee=n("el-dialog"),te=ue("loading");return A(),$("div",null,[e(w,null,{default:o(()=>[e(v,{closable:!1,"show-icon":"",title:"自定义回复说明",description:"当前可设置自定义回复、且可以多种关键词触发回复相同内容、可以开启精准匹配或模糊匹配用户设置自定义回复程度。",type:"success"})]),_:1}),e(w,null,{default:o(()=>[e(Y,{ref_key:"formRef",ref:z,inline:!0,model:u},{default:o(()=>[e(f,{label:"自定义问题",prop:"prompt"},{default:o(()=>[e(x,{modelValue:u.prompt,"onUpdate:modelValue":l[0]||(l[0]=t=>u.prompt=t),placeholder:"自定义问题[模糊搜索]",onKeydown:re(pe(d,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])]),_:1}),e(f,{label:"问题启用状态",prop:"status"},{default:o(()=>[e(K,{modelValue:u.status,"onUpdate:modelValue":l[1]||(l[1]=t=>u.status=t),placeholder:"请选择问题启用状态",clearable:""},{default:o(()=>[(A(!0),$(ie,null,de(s(ye),t=>(A(),q(F,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(f,null,{default:o(()=>[e(m,{type:"primary",onClick:d},{default:o(()=>[p(" 查询 ")]),_:1}),e(m,{onClick:l[2]||(l[2]=t=>O(s(z)))},{default:o(()=>[p(" 重置 ")]),_:1})]),_:1}),e(m,{type:"success",style:{float:"right"},onClick:l[3]||(l[3]=t=>c.value=!0)},{default:o(()=>[p(" 添加新的自动回复 "),e(X,{class:"ml-3"},{default:o(()=>[e(L)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(w,{style:{width:"100%"}},{default:o(()=>[ce((A(),q(J,{border:"",data:s(T),style:{width:"100%"},size:"large"},{default:o(()=>[e(y,{prop:"prompt",label:"提问关键词"}),e(y,{prop:"answer",label:"回复答案"}),e(y,{prop:"status",label:"问题状态",width:"120"},{default:o(t=>[e(G,{type:t.row.status===1?"success":"daner"},{default:o(()=>[p(R(s(ge)[t.row.status]),1)]),_:2},1032,["type"])]),_:1}),e(y,{prop:"createdAt",label:"创建时间",width:"200"},{default:o(t=>[p(R(s(I)(t.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),e(y,{prop:"updatedAt",label:"最后修改时间",width:"200"},{default:o(t=>[p(R(s(I)(t.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),e(y,{fixed:"right",label:"操作",width:"200"},{default:o(t=>[e(m,{link:"",type:"primary",size:"small",onClick:le=>P(t.row)},{default:o(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),e(H,{"confirm-button-text":"确认删除","cancel-button-text":"放弃",type:"danger",width:"230px","icon-color":"red",title:"确定删除本条自动回复问题么？",onConfirm:le=>B(t.row.id)},{reference:o(()=>[e(m,{link:"",type:"danger",size:"small"},{default:o(()=>[p(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[te,s(b)]]),e(Z,{class:"flex justify-end mt-5"},{default:o(()=>[e(W,{"current-page":u.page,"onUpdate:currentPage":l[4]||(l[4]=t=>u.page=t),"page-size":u.size,"onUpdate:pageSize":l[5]||(l[5]=t=>u.size=t),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:s(S),onSizeChange:d,onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),e(ee,{modelValue:s(c),"onUpdate:modelValue":l[11]||(l[11]=t=>_e(c)?c.value=t:null),title:`${s(D)?"编辑":"添加"}自动回复问题`,width:"480",onClose:l[12]||(l[12]=t=>Q(s(h)))},{footer:o(()=>[me("span",ve,[e(m,{onClick:l[9]||(l[9]=t=>c.value=!1)},{default:o(()=>[p("放弃生成")]),_:1}),e(m,{type:"primary",onClick:l[10]||(l[10]=t=>j(s(h)))},{default:o(()=>[p(R(`${s(D)?"更新":"新增"}回复 `),1)]),_:1})])]),default:o(()=>[e(Y,{ref_key:"formAutoReplyRef",ref:h,"label-position":"right","label-width":"80px",model:r,rules:N},{default:o(()=>[e(f,{label:"开启状态",prop:"status"},{default:o(()=>[e(E,{modelValue:r.status,"onUpdate:modelValue":l[6]||(l[6]=t=>r.status=t),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),e(f,{label:"提问问题",prop:"prompt"},{default:o(()=>[e(x,{modelValue:r.prompt,"onUpdate:modelValue":l[7]||(l[7]=t=>r.prompt=t),type:"textarea",rows:5,placeholder:"请填写预设提问问题"},null,8,["modelValue"])]),_:1}),e(f,{label:"回复问题",prop:"answer"},{default:o(()=>[e(x,{modelValue:r.answer,"onUpdate:modelValue":l[8]||(l[8]=t=>r.answer=t),type:"textarea",rows:5,placeholder:"请填写预设回复答案"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});typeof M=="function"&&M(we);export{we as default};
