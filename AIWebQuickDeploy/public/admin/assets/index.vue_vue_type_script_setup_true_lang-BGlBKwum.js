
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import se from"./HKbd-Be5shIQ7.js";import{d as ne,r as h,n as K,f as le,u as oe,a8 as re,ae as ie,X as U,a as ue,af as N,a9 as _,ag as J,g as f,z as S,w as u,b as r,i as n,ah as P,ai as A,e as i,aj as ce,y as de,ak as fe,D as pe,v as T,x as F,al as ve,am as he,c as b,s as G,F as O,h as Q,A as R,an as _e,ao as me,ap as ge,j as xe,Q as X,t as Y}from"./index-6QRvoxq4.js";import ye from"./index-BE5tQEZB.js";import{_ as be}from"./item.vue_vue_type_script_setup_true_lang-Dhzk_uDL.js";const ke=i("div",{class:"fixed inset-0 bg-stone-200/75 backdrop-blur-sm transition-opacity dark-bg-stone-8/75"},null,-1),we={class:"fixed inset-0"},Se={class:"h-full flex items-end justify-center p-4 text-center lg-items-center"},Te={class:"flex flex-col overflow-y-auto rounded-xl bg-white shadow-xl dark-bg-stone-8"},Re={class:"flex items-center px-4 py-3","border-b":"~ solid stone-2 dark-stone-7"},Ce=["onKeydown"],He=["data-index","onClick","onMouseover"],Ie={class:"flex flex-1 flex-col gap-1 truncate px-4 py-3","border-l":"~ solid stone-2 dark-stone-7"},ze={class:"truncate text-base font-bold"},De={key:1,flex:"center col","py-6":"","text-stone-5":""},Be=i("p",{"m-2":"","text-base":""}," 没有找到你想要的 ",-1),Me={key:0,class:"flex justify-between px-4 py-3","border-t":"~ solid stone-2 dark-stone-7"},Ne={class:"flex gap-8"},Fe={class:"inline-flex items-center gap-1 text-xs"},Le=i("span",null,"访问",-1),$e={class:"inline-flex items-center gap-1 text-xs"},Ee=i("span",null,"切换",-1),Ve={key:0,class:"inline-flex items-center gap-1 text-xs"},je=i("span",null,"退出",-1),Ge=ne({name:"Search",__name:"index",setup(Ke){const q=h({enter:"ease-in-out duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0"}),W=K(()=>({enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 lg-translate-y-0 lg-scale-95",enterTo:"opacity-100 translate-y-0 lg-scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 lg-scale-100",leaveTo:"opacity-0 translate-y-4 lg-translate-y-0 lg-scale-95"})),Z=le(),x=oe(),ee=re(),p=h(!1),v=h(""),C=h([]),o=h(-1),L=h(),H=h(),k=h([]);ie(()=>{k.value=[]});const m=K(()=>{let a=[];return a=C.value.filter(t=>{let s=!1;return t.title&&(typeof t.title=="function"?t.title().includes(v.value)&&(s=!0):t.title.includes(v.value)&&(s=!0)),t.path.includes(v.value)&&(s=!0),t.breadcrumb.some(l=>{var e;if(typeof l.title=="function"){if(l.title().includes(v.value))return!0}else if((e=l.title)!=null&&e.includes(v.value))return!0;return!1})&&(s=!0),s}),a});U(()=>p.value,a=>{a?(v.value="",o.value=-1,_("up",z),_("down",D),_("enter",B)):(_.unbind("up",z),_.unbind("down",D),_.unbind("enter",B))}),U(()=>m.value,()=>{o.value=-1,M()}),ue(()=>{N.on("global-search-toggle",()=>{p.value||I(),p.value=!p.value}),_("alt+s",a=>{x.settings.toolbar.navSearch&&x.settings.navSearch.enableHotkeys&&(a.preventDefault(),I(),p.value=!0)}),_("esc",a=>{x.settings.toolbar.navSearch&&x.settings.navSearch.enableHotkeys&&(a.preventDefault(),p.value=!1)}),I()});function I(){C.value=[],ee.allMenus.forEach(a=>{$(a.children)})}function te(a){var s;let t=!0;return(s=a.children)!=null&&s.every(l=>{var e;return((e=l.meta)==null?void 0:e.menu)===!1})&&(t=!1),t}function $(a,t,s,l){a.forEach(e=>{var d,c,g,y,E,V,j;if(((d=e.meta)==null?void 0:d.menu)!==!1){const w=ge(l)||[];e.children&&te(e)?(w.push({title:(c=e.meta)==null?void 0:c.title}),$(e.children,J(t,e.path),((g=e.meta)==null?void 0:g.icon)??s,w)):(w.push({title:(y=e.meta)==null?void 0:y.title}),C.value.push({path:J(t,e.path),icon:((E=e.meta)==null?void 0:E.icon)??s,title:(V=e.meta)==null?void 0:V.title,link:(j=e.meta)==null?void 0:j.link,breadcrumb:w}))}})}function z(){m.value.length&&(o.value-=1,o.value<0&&(o.value=m.value.length-1),M())}function D(){m.value.length&&(o.value+=1,o.value>m.value.length-1&&(o.value=0),M())}function B(){var a;o.value!==-1&&((a=k.value.find(t=>Number.parseInt(t.dataset.index)===o.value))==null||a.click())}function M(){var a,t;if(H.value){const s=H.value.osInstance().elements().content;let l=0;if(o.value!==-1){l=s.scrollTop;const e=((a=k.value.find(y=>Number.parseInt(y.dataset.index)===o.value))==null?void 0:a.offsetTop)??0,d=((t=k.value.find(y=>Number.parseInt(y.dataset.index)===o.value))==null?void 0:t.clientHeight)??0,c=s.scrollTop,g=s.clientHeight;e+d>c+g?l=e+d-g:e<=c&&(l=e)}s.scrollTo({top:l})}}function ae(a,t){t?window.open(t,"_blank"):Z.push(a),p.value=!1}return(a,t)=>{const s=xe,l=se;return f(),S(n(me),{as:"template",show:n(p)},{default:u(()=>[r(n(_e),{"initial-focus":n(L),class:"fixed inset-0 z-2000 flex",onClose:t[2]||(t[2]=e=>n(p)&&n(N).emit("global-search-toggle"))},{default:u(()=>[r(n(P),A({as:"template"},n(q)),{default:u(()=>[ke]),_:1},16),i("div",we,[i("div",Se,[r(n(P),A({as:"template"},n(W)),{default:u(()=>[r(n(ce),{class:"relative h-full max-h-4/5 w-full flex flex-col text-left lg-max-w-2xl"},{default:u(()=>[i("div",Te,[i("div",Re,[r(s,{name:"i-ep:search",size:18,class:"text-stone-5"}),de(i("input",{ref_key:"searchInputRef",ref:L,"onUpdate:modelValue":t[0]||(t[0]=e=>pe(v)?v.value=e:null),placeholder:"搜索页面，支持标题、URL模糊查询",class:"w-full border-0 rounded-md bg-transparent px-3 text-base text-dark dark-text-white focus-outline-none placeholder-stone-4 dark-placeholder-stone-5",onKeydown:[t[1]||(t[1]=T(e=>n(N).emit("global-search-toggle"),["esc"])),T(F(z,["prevent"]),["up"]),T(F(D,["prevent"]),["down"]),T(F(B,["prevent"]),["enter"])]},null,40,Ce),[[fe,n(v)]])]),r(n(ve),{class:"relative m-0 of-y-hidden"},{default:u(()=>[r(n(he),{ref_key:"searchResultRef",ref:H,options:{scrollbars:{autoHide:"leave",autoHideDelay:300}},defer:"",class:"h-full"},{default:u(()=>[n(m).length>0?(f(!0),b(O,{key:0},G(n(m),(e,d)=>(f(),b("a",{ref_for:!0,ref_key:"searchResultItemRef",ref:k,key:e.path,class:X(["flex cursor-pointer items-center",{"bg-stone-2/40 dark-bg-stone-7/40":d===n(o)}]),"data-index":d,onClick:c=>ae(e.path,e.link),onMouseover:c=>o.value=d},[e.icon?(f(),S(s,{key:0,name:e.icon,size:20,class:X(["basis-16 transition",{"scale-120 text-ui-primary":d===n(o)}])},null,8,["name","class"])):R("",!0),i("div",Ie,[i("div",ze,Y((typeof e.title=="function"?e.title():e.title)??"[ 无标题 ]"),1),e.breadcrumb.length?(f(),S(ye,{key:0,class:"truncate"},{default:u(()=>[(f(!0),b(O,null,G(e.breadcrumb,(c,g)=>(f(),S(be,{key:g,class:"text-xs"},{default:u(()=>[Q(Y((typeof c.title=="function"?c.title():c.title)??"[ 无标题 ]"),1)]),_:2},1024))),128))]),_:2},1024)):R("",!0)])],42,He))),128)):(f(),b("div",De,[r(s,{name:"i-tabler:mood-empty",size:40}),Be]))]),_:1},512)]),_:1}),n(x).mode==="pc"?(f(),b("div",Me,[i("div",Ne,[i("div",Fe,[r(l,null,{default:u(()=>[r(s,{name:"i-ion:md-return-left",size:14})]),_:1}),Le]),i("div",$e,[r(l,null,{default:u(()=>[r(s,{name:"i-ant-design:caret-up-filled",size:14})]),_:1}),r(l,null,{default:u(()=>[r(s,{name:"i-ant-design:caret-down-filled",size:14})]),_:1}),Ee])]),n(x).settings.navSearch.enableHotkeys?(f(),b("div",Ve,[r(l,null,{default:u(()=>[Q(" ESC ")]),_:1}),je])):R("",!0)])):R("",!0)])]),_:1})]),_:1},16)])])]),_:1},8,["initial-focus"])]),_:1},8,["show"])}}});export{Ge as _};
